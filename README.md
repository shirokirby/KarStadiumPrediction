# KarStadiumPrediction
カービィのエアライドで、シティトライアルのスタジアムを欲しいものにするための乱数調整用プログラムです。  
実行ファイル https://drive.google.com/file/d/1xQcQI26Pw4eCK4djCIKVi-4FkxcAHPH6/view?usp=drive_link
## 前提知識
カービィのエアライドで使われる乱数は、メニュー画面では決められた動作をする際のみ消費します。
* シティトライアルモードでプレイヤーエントリー画面に入る（Zボタンでゲーム設定に入り戻った場合も消費） → 1消費
* スタジアムモードに入る → 1消費
* ドライブモードに入る → 1消費
* 任意のモードのプレイヤーエントリー画面でCPUがエントリーする → エントリーしたCPUの数消費
* データ全消去 → 355消費
### 乱数値の特定
乱数値は以下の式で決定されます。  
r1 = (r0 * 214013 + 2531011) % 4294967296  
スタジアムモードでCPUがエントリーした時、乱数が消費されますが、この乱数値によってCPUのマシンが決定されます。  
このマシンの種類を10個ほど連続で抜き出すことで、現在の乱数値を特定することが可能です。

**参考資料**  
*カービィのエアライド@走法まとめ Wiki* https://wikiwiki.jp/airride/%E4%B9%B1%E6%95%B0%E8%AA%BF%E6%95%B4%20(WIP)
### スタジアムの決定
シティトライアルは、過去4試合で選ばれたスタジアムは除外されるという裏仕様があります（シャッフル設定のみ）。  
スタジアムが決定されるタイミングは、上記の各モードに入った時の乱数1消費の時です。  
実際にスタジアムを遊んでいなくても、過去4試合のスタジアムメモリに格納されていきます。  
例えば、ゲーム設定のスタジアムをポイントストライクにしておき、スタジアムモードに4回入り、その後ゲーム設定でシャッフルに戻して、シティトライアルモードに入ったとします。  
この時点でスタジアムが決定されますが、過去4試合のスタジアムが全てポイントストライクになっているため、その試合でポイントストライクが選ばれることはありません。
## 引数
### マシンIDの指定
1つ目の引数にはマシンIDを10文字で入力します。
* 1 = ジェットスター
* 2 = フォーミュラスター
* 3 = ウィングスター
* 4 = ワープスター
* 5 = ライトスター
* 6 = デビルスター
* 7 = ワゴンスター
* 8 = ルインズスター
* A = ロケットスター
* B = ターボスター
* C = ヘビースター
* D = スリックスター
* E = ウィリーバイク
* F = ウィリースクーター
* G = レックスウィリー

### 除外するスタジアムを指定
2つ目以降の引数に、1～24の数値を入力すると、その数値に対応したスタジアムが予測から除外されます。
* 1 = ゼロヨンアタック1
* 2 = ゼロヨンアタック2
* 3 = ゼロヨンアタック3
* 4 = ゼロヨンアタック4
* 5 = エアグライダー
* 6 = ポイントストライク
* 7 = ハイジャンプ
* 8 = バトルロイヤル1
* 9 = バトルロイヤル2
* 10 = デスマッチ1
* 11 = デスマッチ2
* 12 = デスマッチ3
* 13 = デスマッチ4
* 14 = デスマッチ5
* 15 = シングルレース プランテス
* 16 = シングルレース マグヒート
* 17 = シングルレース サンドーラ
* 18 = シングルレース コルダ
* 19 = シングルレース アイルーン
* 20 = シングルレース ヴァレリオン
* 21 = シングルレース スチールオーガン
* 22 = シングルレース チェックナイト
* 23 = シングルレース ギャラックス
* 24 = VSデデデ

シャッフル設定の場合、意図しなくても大抵過去4試合のスタジアムメモリに何かが入っているため、最初はポイントストライクなどで埋めておくのを推奨します。  

**-l, --lock**

未解禁のスタジアムを予測から除外するオプションです。  
4, 9, 12, 13, 14, 23の6つの引数を入力した時と同じ働きをします。

**dr, DR**

予測をゼロヨンアタックだけにするオプションです。  
ゲーム設定のスタジアムをゼロヨンアタックに変更する時に使います。

**km, KM**

予測をバトルロイヤルだけにするオプションです。

**dd, DD**

予測をデスマッチだけにするオプションです。

**sr, SR**

予測をシングルレースだけにするオプションです。
## 出力
1列目に現在の乱数値からの消費数、2列目に出現するスタジアムの番号を出力します。  
例えば、出力結果が以下のような時、現在の乱数値からさらに5消費した状態で、スタジアムをシャッフル設定にしてシティトライアルモードに入ると、シングルレース ギャラックスが出現します。
```
> .\KarStadiumPrediction.exe 7CBDB33567 6
0       19
1       9
2       9
3       1
4       10
5       23
6       11
7       11
8       1
9       14
10      23
```
